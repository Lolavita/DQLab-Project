#Showing the total sales and total order from 2009-2012

SELECT year(order_date) AS years, 
SUM(sales) AS sales, 
COUNT (order_id) AS number_of_order 
from dqlab_sales_store 
where order_status = "Order Finished" 
GROUP BY year(order_date);

#Showing the total sales based on the product sub category only in 2011 and 2012

SELECT year(order_date) AS years,
product_sub_category,
SUM(sales) AS sales 
FROM dqlab_sales_store 
WHERE year(order_date) BETWEEN 2011 AND 2012 
AND order_status = "Order Finished" 
GROUP BY year(order_date), product_sub_category 
ORDER BY year(order_date), sales DESC;

#Create Derived Tables to count the total sales and total discount sort by year and counting the burn rate percentage (total discount / total sales) * 100) with maximum burn rate 4.5%

SELECT year(order_date) AS years,
SUM(sales) AS sales, 
SUM(discount_value) AS promotion_value,
ROUND((ROUND(SUM(discount_value),2)/ROUND(SUM(sales),2))*100,2) AS burn_rate_percentage 
FROM dqlab_sales_store 
WHERE order_status = "Order Finished"
GROUP BY year(order_date) 
ORDER BY year(order_date);

#Showing the data only in 2012 and adding 2 columns (product_sub_category and product_category)

SELECT year(order_date) AS years,
product_sub_category, 
product_category,
SUM(sales) as sales,
SUM(discount_value) AS promotion_value, 
ROUND((ROUND(SUM(discount_value),2)/ROUND(SUM(sales),2))*100,2) AS burn_rate_percentage
FROM dqlab_sales_store
WHERE year(order_date) = 2012 AND order_status = "Order Finished"
GROUP BY product_category, product_sub_category, year(order_date) 
ORDER BY sales DESC;
